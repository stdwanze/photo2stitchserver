<!DOCTYPE HTML>
<html>
	<head>
		<title>Factorio Sales Data</title>

		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
		 <style>
	      body {
	        font-family: 'Open Sans', sans-serif;
	      }
   		</style>
		<script type="text/javascript">
			var fake = false;
			
			var fakeData = JSON.parse("[{\"_date\":\"8_6_2014\",\"max\":35783,\"min\":35754,\"sold\":29,\"date\":\"2014-07-08T23:00:02.635Z\",\"avg\":3.2222222222222223,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"9_6_2014\",\"max\":35874,\"min\":35785,\"sold\":89,\"date\":\"2014-07-09T23:00:03.158Z\",\"avg\":3.7083333333333335,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"10_6_2014\",\"max\":35965,\"min\":35878,\"sold\":87,\"date\":\"2014-07-10T23:00:03.631Z\",\"avg\":3.625,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"11_6_2014\",\"max\":36055,\"min\":35969,\"sold\":86,\"date\":\"2014-07-11T23:00:03.302Z\",\"avg\":3.5833333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"12_6_2014\",\"max\":36142,\"min\":36056,\"sold\":86,\"date\":\"2014-07-12T23:00:03.705Z\",\"avg\":3.5833333333333335,\"hourlymax\":12,\"hourlymin\":1},{\"_date\":\"13_6_2014\",\"max\":36262,\"min\":36143,\"sold\":119,\"date\":\"2014-07-13T23:00:03.158Z\",\"avg\":4.958333333333333,\"hourlymax\":10,\"hourlymin\":2},{\"_date\":\"14_6_2014\",\"max\":36359,\"min\":36264,\"sold\":95,\"date\":\"2014-07-14T23:00:03.150Z\",\"avg\":3.9583333333333335,\"hourlymax\":15,\"hourlymin\":1},{\"_date\":\"15_6_2014\",\"max\":36436,\"min\":36362,\"sold\":74,\"date\":\"2014-07-15T23:00:02.753Z\",\"avg\":3.0833333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"16_6_2014\",\"max\":36503,\"min\":36438,\"sold\":65,\"date\":\"2014-07-16T23:00:02.362Z\",\"avg\":2.7083333333333335,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"17_6_2014\",\"max\":36580,\"min\":36506,\"sold\":74,\"date\":\"2014-07-17T23:00:03.078Z\",\"avg\":3.0833333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"18_6_2014\",\"max\":36640,\"min\":36583,\"sold\":57,\"date\":\"2014-07-18T23:00:02.880Z\",\"avg\":2.375,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"19_6_2014\",\"max\":36713,\"min\":36640,\"sold\":73,\"date\":\"2014-07-19T23:00:03.117Z\",\"avg\":3.0416666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"20_6_2014\",\"max\":36789,\"min\":36716,\"sold\":73,\"date\":\"2014-07-20T23:00:03.184Z\",\"avg\":3.0416666666666665,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"21_6_2014\",\"max\":36853,\"min\":36792,\"sold\":61,\"date\":\"2014-07-21T23:00:03.240Z\",\"avg\":2.5416666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"22_6_2014\",\"max\":36916,\"min\":36856,\"sold\":60,\"date\":\"2014-07-22T23:00:03.032Z\",\"avg\":2.5,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"23_6_2014\",\"max\":36977,\"min\":36919,\"sold\":58,\"date\":\"2014-07-23T23:00:03.694Z\",\"avg\":2.4166666666666665,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"24_6_2014\",\"max\":37036,\"min\":36977,\"sold\":59,\"date\":\"2014-07-24T23:00:02.365Z\",\"avg\":2.4583333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"25_6_2014\",\"max\":37099,\"min\":37039,\"sold\":60,\"date\":\"2014-07-25T23:00:03.021Z\",\"avg\":2.5,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"26_6_2014\",\"max\":37171,\"min\":37100,\"sold\":71,\"date\":\"2014-07-26T23:00:02.919Z\",\"avg\":2.9583333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"27_6_2014\",\"max\":37231,\"min\":37173,\"sold\":58,\"date\":\"2014-07-27T23:00:02.834Z\",\"avg\":2.4166666666666665,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"28_6_2014\",\"max\":37322,\"min\":37234,\"sold\":88,\"date\":\"2014-07-28T23:00:02.901Z\",\"avg\":3.6666666666666665,\"hourlymax\":15,\"hourlymin\":1},{\"_date\":\"29_6_2014\",\"max\":37519,\"min\":37328,\"sold\":191,\"date\":\"2014-07-29T23:00:02.944Z\",\"avg\":7.958333333333333,\"hourlymax\":19,\"hourlymin\":3},{\"_date\":\"30_6_2014\",\"max\":37709,\"min\":37530,\"sold\":179,\"date\":\"2014-07-30T23:00:03.799Z\",\"avg\":7.458333333333333,\"hourlymax\":20,\"hourlymin\":2},{\"_date\":\"31_6_2014\",\"max\":38068,\"min\":37718,\"sold\":350,\"date\":\"2014-07-31T23:00:03.217Z\",\"avg\":14.583333333333334,\"hourlymax\":111,\"hourlymin\":2},{\"_date\":\"1_7_2014\",\"max\":39588,\"min\":38142,\"sold\":1446,\"date\":\"2014-08-01T23:00:03.146Z\",\"avg\":60.25,\"hourlymax\":93,\"hourlymin\":26},{\"_date\":\"2_7_2014\",\"max\":40674,\"min\":39647,\"sold\":1027,\"date\":\"2014-08-02T23:00:02.719Z\",\"avg\":42.791666666666664,\"hourlymax\":65,\"hourlymin\":19},{\"_date\":\"3_7_2014\",\"max\":41329,\"min\":40719,\"sold\":610,\"date\":\"2014-08-03T23:00:03.318Z\",\"avg\":25.416666666666668,\"hourlymax\":43,\"hourlymin\":11},{\"_date\":\"4_7_2014\",\"max\":41813,\"min\":41355,\"sold\":458,\"date\":\"2014-08-04T23:00:02.631Z\",\"avg\":19.083333333333332,\"hourlymax\":36,\"hourlymin\":6},{\"_date\":\"5_7_2014\",\"max\":42215,\"min\":41835,\"sold\":380,\"date\":\"2014-08-05T23:00:02.613Z\",\"avg\":15.833333333333334,\"hourlymax\":32,\"hourlymin\":3},{\"_date\":\"6_7_2014\",\"max\":42528,\"min\":42227,\"sold\":301,\"date\":\"2014-08-06T23:00:03.111Z\",\"avg\":12.541666666666666,\"hourlymax\":28,\"hourlymin\":5},{\"_date\":\"7_7_2014\",\"max\":42787,\"min\":42535,\"sold\":252,\"date\":\"2014-08-07T23:00:03.478Z\",\"avg\":10.5,\"hourlymax\":20,\"hourlymin\":4},{\"_date\":\"8_7_2014\",\"max\":43003,\"min\":42798,\"sold\":205,\"date\":\"2014-08-08T23:00:02.441Z\",\"avg\":8.541666666666666,\"hourlymax\":24,\"hourlymin\":2},{\"_date\":\"9_7_2014\",\"max\":43263,\"min\":43014,\"sold\":249,\"date\":\"2014-08-09T23:00:02.524Z\",\"avg\":10.375,\"hourlymax\":22,\"hourlymin\":4},{\"_date\":\"10_7_2014\",\"max\":43476,\"min\":43272,\"sold\":204,\"date\":\"2014-08-10T23:00:03.055Z\",\"avg\":8.5,\"hourlymax\":19,\"hourlymin\":2},{\"_date\":\"11_7_2014\",\"max\":43648,\"min\":43484,\"sold\":164,\"date\":\"2014-08-11T23:00:03.293Z\",\"avg\":6.833333333333333,\"hourlymax\":15,\"hourlymin\":2},{\"_date\":\"12_7_2014\",\"max\":43786,\"min\":43655,\"sold\":131,\"date\":\"2014-08-12T23:00:02.942Z\",\"avg\":5.458333333333333,\"hourlymax\":13,\"hourlymin\":2},{\"_date\":\"13_7_2014\",\"max\":43894,\"min\":43791,\"sold\":103,\"date\":\"2014-08-13T23:00:02.871Z\",\"avg\":4.291666666666667,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"14_7_2014\",\"max\":44025,\"min\":43898,\"sold\":127,\"date\":\"2014-08-14T23:00:03.445Z\",\"avg\":5.291666666666667,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"15_7_2014\",\"max\":44143,\"min\":44034,\"sold\":109,\"date\":\"2014-08-15T23:00:03.154Z\",\"avg\":4.541666666666667,\"hourlymax\":13,\"hourlymin\":1},{\"_date\":\"16_7_2014\",\"max\":44265,\"min\":44146,\"sold\":119,\"date\":\"2014-08-16T23:00:02.922Z\",\"avg\":4.958333333333333,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"17_7_2014\",\"max\":44387,\"min\":44268,\"sold\":119,\"date\":\"2014-08-17T23:00:03.309Z\",\"avg\":4.958333333333333,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"18_7_2014\",\"max\":44505,\"min\":44387,\"sold\":118,\"date\":\"2014-08-18T23:00:02.818Z\",\"avg\":4.916666666666667,\"hourlymax\":13,\"hourlymin\":2},{\"_date\":\"19_7_2014\",\"max\":44604,\"min\":44509,\"sold\":95,\"date\":\"2014-08-19T23:00:03.290Z\",\"avg\":3.9583333333333335,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"20_7_2014\",\"max\":44688,\"min\":44612,\"sold\":76,\"date\":\"2014-08-20T23:00:03.527Z\",\"avg\":3.1666666666666665,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"21_7_2014\",\"max\":44775,\"min\":44688,\"sold\":87,\"date\":\"2014-08-21T23:00:02.747Z\",\"avg\":3.625,\"hourlymax\":14,\"hourlymin\":1},{\"_date\":\"22_7_2014\",\"max\":44870,\"min\":44781,\"sold\":89,\"date\":\"2014-08-22T23:00:03.639Z\",\"avg\":3.7083333333333335,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"23_7_2014\",\"max\":44878,\"min\":44878,\"sold\":0,\"date\":\"2014-08-23T00:00:03.520Z\",\"avg\":0,\"hourlymax\":0,\"hourlymin\":999999999},{\"_date\":\"31_7_2014\",\"max\":45747,\"min\":45686,\"sold\":61,\"date\":\"2014-08-31T23:00:03.623Z\",\"avg\":6.1,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"1_8_2014\",\"max\":45841,\"min\":45753,\"sold\":88,\"date\":\"2014-09-01T23:00:03.025Z\",\"avg\":3.6666666666666665,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"2_8_2014\",\"max\":45914,\"min\":45841,\"sold\":73,\"date\":\"2014-09-02T23:00:03.360Z\",\"avg\":3.0416666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"3_8_2014\",\"max\":45990,\"min\":45917,\"sold\":73,\"date\":\"2014-09-03T23:00:03.214Z\",\"avg\":3.1739130434782608,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"4_8_2014\",\"max\":46059,\"min\":45992,\"sold\":67,\"date\":\"2014-09-04T23:00:03.095Z\",\"avg\":2.7916666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"5_8_2014\",\"max\":46130,\"min\":46062,\"sold\":68,\"date\":\"2014-09-05T23:00:02.789Z\",\"avg\":2.8333333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"6_8_2014\",\"max\":46220,\"min\":46134,\"sold\":86,\"date\":\"2014-09-06T23:00:03.053Z\",\"avg\":3.5833333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"7_8_2014\",\"max\":46309,\"min\":46226,\"sold\":83,\"date\":\"2014-09-07T23:00:03.004Z\",\"avg\":3.4583333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"8_8_2014\",\"max\":46361,\"min\":46311,\"sold\":50,\"date\":\"2014-09-08T23:00:02.658Z\",\"avg\":2.0833333333333335,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"9_8_2014\",\"max\":46418,\"min\":46363,\"sold\":55,\"date\":\"2014-09-09T23:00:03.169Z\",\"avg\":2.2916666666666665,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"10_8_2014\",\"max\":46487,\"min\":46418,\"sold\":69,\"date\":\"2014-09-10T23:00:03.805Z\",\"avg\":2.875,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"11_8_2014\",\"max\":46542,\"min\":46489,\"sold\":53,\"date\":\"2014-09-11T23:00:03.320Z\",\"avg\":2.2083333333333335,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"12_8_2014\",\"max\":46611,\"min\":46546,\"sold\":65,\"date\":\"2014-09-12T21:00:02.919Z\",\"avg\":2.9545454545454546,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"13_8_2014\",\"max\":46709,\"min\":46653,\"sold\":56,\"date\":\"2014-09-13T23:00:03.522Z\",\"avg\":4.3076923076923075,\"hourlymax\":7,\"hourlymin\":2},{\"_date\":\"14_8_2014\",\"max\":46791,\"min\":46712,\"sold\":79,\"date\":\"2014-09-14T23:00:02.901Z\",\"avg\":3.2916666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"15_8_2014\",\"max\":46862,\"min\":46793,\"sold\":69,\"date\":\"2014-09-15T23:00:02.956Z\",\"avg\":2.875,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"16_8_2014\",\"max\":46925,\"min\":46863,\"sold\":62,\"date\":\"2014-09-16T23:00:02.695Z\",\"avg\":2.5833333333333335,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"17_8_2014\",\"max\":46983,\"min\":46928,\"sold\":55,\"date\":\"2014-09-17T23:00:02.781Z\",\"avg\":2.2916666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"18_8_2014\",\"max\":47042,\"min\":46986,\"sold\":56,\"date\":\"2014-09-18T23:00:02.333Z\",\"avg\":2.3333333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"19_8_2014\",\"max\":47123,\"min\":47044,\"sold\":79,\"date\":\"2014-09-19T23:00:03.465Z\",\"avg\":3.2916666666666665,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"20_8_2014\",\"max\":47205,\"min\":47126,\"sold\":79,\"date\":\"2014-09-20T23:00:02.645Z\",\"avg\":3.761904761904762,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"21_8_2014\",\"max\":47270,\"min\":47206,\"sold\":64,\"date\":\"2014-09-21T23:00:03.269Z\",\"avg\":2.6666666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"22_8_2014\",\"max\":47315,\"min\":47274,\"sold\":41,\"date\":\"2014-09-22T23:00:02.306Z\",\"avg\":1.7083333333333333,\"hourlymax\":4,\"hourlymin\":1},{\"_date\":\"23_8_2014\",\"max\":47360,\"min\":47318,\"sold\":42,\"date\":\"2014-09-23T23:00:02.482Z\",\"avg\":1.75,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"24_8_2014\",\"max\":47419,\"min\":47363,\"sold\":56,\"date\":\"2014-09-24T23:00:02.893Z\",\"avg\":2.3333333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"25_8_2014\",\"max\":47453,\"min\":47422,\"sold\":31,\"date\":\"2014-09-25T23:00:02.589Z\",\"avg\":1.2916666666666667,\"hourlymax\":4,\"hourlymin\":1},{\"_date\":\"26_8_2014\",\"max\":47501,\"min\":47456,\"sold\":45,\"date\":\"2014-09-26T23:00:02.352Z\",\"avg\":1.875,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"27_8_2014\",\"max\":47567,\"min\":47502,\"sold\":65,\"date\":\"2014-09-27T23:00:02.925Z\",\"avg\":2.7083333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"28_8_2014\",\"max\":47635,\"min\":47570,\"sold\":65,\"date\":\"2014-09-28T23:00:03.498Z\",\"avg\":2.7083333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"29_8_2014\",\"max\":47689,\"min\":47637,\"sold\":52,\"date\":\"2014-09-29T23:00:02.265Z\",\"avg\":2.1666666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"30_8_2014\",\"max\":47741,\"min\":47691,\"sold\":50,\"date\":\"2014-09-30T23:00:03.427Z\",\"avg\":2.0833333333333335,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"1_9_2014\",\"max\":47801,\"min\":47741,\"sold\":60,\"date\":\"2014-10-01T23:00:03.715Z\",\"avg\":2.5,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"2_9_2014\",\"max\":47863,\"min\":47805,\"sold\":58,\"date\":\"2014-10-02T23:00:03.238Z\",\"avg\":2.4166666666666665,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"3_9_2014\",\"max\":47926,\"min\":47868,\"sold\":58,\"date\":\"2014-10-03T23:00:02.796Z\",\"avg\":2.4166666666666665,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"4_9_2014\",\"max\":48003,\"min\":47931,\"sold\":72,\"date\":\"2014-10-04T23:00:03.632Z\",\"avg\":3,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"5_9_2014\",\"max\":48070,\"min\":48005,\"sold\":65,\"date\":\"2014-10-05T23:00:02.396Z\",\"avg\":2.7083333333333335,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"6_9_2014\",\"max\":48122,\"min\":48074,\"sold\":48,\"date\":\"2014-10-06T23:00:02.912Z\",\"avg\":2,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"7_9_2014\",\"max\":48169,\"min\":48124,\"sold\":45,\"date\":\"2014-10-07T23:00:02.834Z\",\"avg\":1.875,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"8_9_2014\",\"max\":48214,\"min\":48171,\"sold\":43,\"date\":\"2014-10-08T23:00:03.427Z\",\"avg\":1.7916666666666667,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"9_9_2014\",\"max\":48263,\"min\":48216,\"sold\":47,\"date\":\"2014-10-09T23:00:05.755Z\",\"avg\":1.9583333333333333,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"10_9_2014\",\"max\":48330,\"min\":48264,\"sold\":66,\"date\":\"2014-10-10T23:00:03.276Z\",\"avg\":2.75,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"11_9_2014\",\"max\":48401,\"min\":48331,\"sold\":70,\"date\":\"2014-10-11T23:00:03.197Z\",\"avg\":2.9166666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"12_9_2014\",\"max\":48473,\"min\":48404,\"sold\":69,\"date\":\"2014-10-12T23:00:02.647Z\",\"avg\":3,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"13_9_2014\",\"max\":48528,\"min\":48474,\"sold\":54,\"date\":\"2014-10-13T23:00:02.793Z\",\"avg\":2.25,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"14_9_2014\",\"max\":48569,\"min\":48529,\"sold\":40,\"date\":\"2014-10-14T23:00:02.640Z\",\"avg\":1.6666666666666667,\"hourlymax\":4,\"hourlymin\":1},{\"_date\":\"15_9_2014\",\"max\":48623,\"min\":48569,\"sold\":54,\"date\":\"2014-10-15T23:00:03.340Z\",\"avg\":2.25,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"16_9_2014\",\"max\":48671,\"min\":48623,\"sold\":48,\"date\":\"2014-10-16T23:00:03.187Z\",\"avg\":2,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"17_9_2014\",\"max\":48724,\"min\":48672,\"sold\":52,\"date\":\"2014-10-17T23:00:03.210Z\",\"avg\":2.1666666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"18_9_2014\",\"max\":48805,\"min\":48727,\"sold\":78,\"date\":\"2014-10-18T23:00:03.220Z\",\"avg\":3.25,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"19_9_2014\",\"max\":48891,\"min\":48808,\"sold\":83,\"date\":\"2014-10-19T23:00:03.441Z\",\"avg\":3.4583333333333335,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"20_9_2014\",\"max\":48966,\"min\":48894,\"sold\":72,\"date\":\"2014-10-20T23:00:03.604Z\",\"avg\":3,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"21_9_2014\",\"max\":49040,\"min\":48967,\"sold\":73,\"date\":\"2014-10-21T23:00:02.894Z\",\"avg\":3.0416666666666665,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"22_9_2014\",\"max\":49106,\"min\":49045,\"sold\":61,\"date\":\"2014-10-22T23:00:03.466Z\",\"avg\":2.5416666666666665,\"hourlymax\":7,\"hourlymin\":1},{\"_date\":\"23_9_2014\",\"max\":49151,\"min\":49107,\"sold\":44,\"date\":\"2014-10-23T23:00:03.291Z\",\"avg\":1.8333333333333333,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"24_9_2014\",\"max\":49199,\"min\":49153,\"sold\":46,\"date\":\"2014-10-24T23:00:02.850Z\",\"avg\":1.9166666666666667,\"hourlymax\":5,\"hourlymin\":1},{\"_date\":\"25_9_2014\",\"max\":49257,\"min\":49201,\"sold\":56,\"date\":\"2014-10-25T23:00:03.468Z\",\"avg\":2.3333333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"26_9_2014\",\"max\":49332,\"min\":49260,\"sold\":72,\"date\":\"2014-10-26T23:00:03.176Z\",\"avg\":3,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"27_9_2014\",\"max\":49382,\"min\":49333,\"sold\":49,\"date\":\"2014-10-27T23:00:03.782Z\",\"avg\":2.0416666666666665,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"28_9_2014\",\"max\":49432,\"min\":49384,\"sold\":48,\"date\":\"2014-10-28T23:00:02.881Z\",\"avg\":2,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"29_9_2014\",\"max\":49495,\"min\":49433,\"sold\":62,\"date\":\"2014-10-29T23:00:03.417Z\",\"avg\":2.5833333333333335,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"30_9_2014\",\"max\":49550,\"min\":49497,\"sold\":53,\"date\":\"2014-10-30T23:00:03.231Z\",\"avg\":2.2083333333333335,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"31_9_2014\",\"max\":49712,\"min\":49553,\"sold\":159,\"date\":\"2014-10-31T23:00:03.109Z\",\"avg\":6.625,\"hourlymax\":26,\"hourlymin\":1},{\"_date\":\"1_10_2014\",\"max\":49963,\"min\":49725,\"sold\":238,\"date\":\"2014-11-01T23:00:03.188Z\",\"avg\":9.916666666666666,\"hourlymax\":22,\"hourlymin\":4},{\"_date\":\"2_10_2014\",\"max\":50139,\"min\":49971,\"sold\":168,\"date\":\"2014-11-02T23:00:03.746Z\",\"avg\":7,\"hourlymax\":14,\"hourlymin\":2},{\"_date\":\"3_10_2014\",\"max\":50257,\"min\":50145,\"sold\":112,\"date\":\"2014-11-03T23:00:03.737Z\",\"avg\":4.666666666666667,\"hourlymax\":11,\"hourlymin\":1},{\"_date\":\"4_10_2014\",\"max\":50361,\"min\":50261,\"sold\":100,\"date\":\"2014-11-04T23:00:03.581Z\",\"avg\":4.166666666666667,\"hourlymax\":9,\"hourlymin\":2},{\"_date\":\"5_10_2014\",\"max\":50455,\"min\":50362,\"sold\":93,\"date\":\"2014-11-05T23:00:02.900Z\",\"avg\":3.875,\"hourlymax\":8,\"hourlymin\":1},{\"_date\":\"6_10_2014\",\"max\":50564,\"min\":50462,\"sold\":102,\"date\":\"2014-11-06T23:00:03.763Z\",\"avg\":4.25,\"hourlymax\":12,\"hourlymin\":1},{\"_date\":\"7_10_2014\",\"max\":50682,\"min\":50570,\"sold\":112,\"date\":\"2014-11-07T23:00:02.951Z\",\"avg\":4.666666666666667,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"8_10_2014\",\"max\":50821,\"min\":50688,\"sold\":133,\"date\":\"2014-11-08T23:00:03.746Z\",\"avg\":5.541666666666667,\"hourlymax\":14,\"hourlymin\":2},{\"_date\":\"9_10_2014\",\"max\":50945,\"min\":50830,\"sold\":115,\"date\":\"2014-11-09T23:00:03.453Z\",\"avg\":4.791666666666667,\"hourlymax\":13,\"hourlymin\":1},{\"_date\":\"10_10_2014\",\"max\":51072,\"min\":50954,\"sold\":118,\"date\":\"2014-11-10T23:00:03.535Z\",\"avg\":4.916666666666667,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"11_10_2014\",\"max\":51151,\"min\":51077,\"sold\":74,\"date\":\"2014-11-11T23:00:02.944Z\",\"avg\":3.0833333333333335,\"hourlymax\":9,\"hourlymin\":1},{\"_date\":\"12_10_2014\",\"max\":51215,\"min\":51152,\"sold\":63,\"date\":\"2014-11-12T23:00:03.563Z\",\"avg\":2.625,\"hourlymax\":6,\"hourlymin\":1},{\"_date\":\"13_10_2014\",\"max\":51330,\"min\":51217,\"sold\":113,\"date\":\"2014-11-13T23:00:03.295Z\",\"avg\":4.708333333333333,\"hourlymax\":10,\"hourlymin\":1},{\"_date\":\"14_10_2014\",\"max\":51487,\"min\":51332,\"sold\":155,\"date\":\"2014-11-14T23:00:03.224Z\",\"avg\":6.458333333333333,\"hourlymax\":12,\"hourlymin\":1},{\"_date\":\"15_10_2014\",\"max\":51713,\"min\":51500,\"sold\":213,\"date\":\"2014-11-15T23:00:02.953Z\",\"avg\":8.875,\"hourlymax\":29,\"hourlymin\":2},{\"_date\":\"16_10_2014\",\"max\":52135,\"min\":51726,\"sold\":409,\"date\":\"2014-11-16T23:00:03.109Z\",\"avg\":17.041666666666668,\"hourlymax\":35,\"hourlymin\":8},{\"_date\":\"17_10_2014\",\"max\":52386,\"min\":52145,\"sold\":241,\"date\":\"2014-11-17T23:00:03.393Z\",\"avg\":10.041666666666666,\"hourlymax\":20,\"hourlymin\":4},{\"_date\":\"18_10_2014\",\"max\":52649,\"min\":52396,\"sold\":253,\"date\":\"2014-11-18T23:00:02.986Z\",\"avg\":10.541666666666666,\"hourlymax\":24,\"hourlymin\":3},{\"_date\":\"19_10_2014\",\"max\":52864,\"min\":52656,\"sold\":208,\"date\":\"2014-11-19T23:00:03.896Z\",\"avg\":10.947368421052632,\"hourlymax\":38,\"hourlymin\":3},{\"_date\":\"20_10_2014\",\"max\":53089,\"min\":52875,\"sold\":214,\"date\":\"2014-11-20T23:00:03.112Z\",\"avg\":8.916666666666666,\"hourlymax\":19,\"hourlymin\":2},{\"_date\":\"21_10_2014\",\"max\":53323,\"min\":53103,\"sold\":220,\"date\":\"2014-11-21T23:00:03.627Z\",\"avg\":9.166666666666666,\"hourlymax\":25,\"hourlymin\":2},{\"_date\":\"22_10_2014\",\"max\":53644,\"min\":53342,\"sold\":302,\"date\":\"2014-11-22T23:00:03.147Z\",\"avg\":12.583333333333334,\"hourlymax\":29,\"hourlymin\":4},{\"_date\":\"23_10_2014\",\"max\":53942,\"min\":53664,\"sold\":278,\"date\":\"2014-11-23T23:00:02.725Z\",\"avg\":11.583333333333334,\"hourlymax\":25,\"hourlymin\":3},{\"_date\":\"24_10_2014\",\"max\":54179,\"min\":53945,\"sold\":234,\"date\":\"2014-11-24T23:00:03.509Z\",\"avg\":9.75,\"hourlymax\":26,\"hourlymin\":2},{\"_date\":\"25_10_2014\",\"max\":54385,\"min\":54188,\"sold\":197,\"date\":\"2014-11-25T23:00:03.500Z\",\"avg\":8.208333333333334,\"hourlymax\":19,\"hourlymin\":1},{\"_date\":\"26_10_2014\",\"max\":54628,\"min\":54397,\"sold\":231,\"date\":\"2014-11-26T23:00:02.984Z\",\"avg\":9.625,\"hourlymax\":17,\"hourlymin\":3},{\"_date\":\"28_10_2014\",\"max\":55036,\"min\":54893,\"sold\":143,\"date\":\"2014-11-28T23:00:03.381Z\",\"avg\":8.411764705882353,\"hourlymax\":18,\"hourlymin\":1},{\"_date\":\"29_10_2014\",\"max\":55275,\"min\":55050,\"sold\":225,\"date\":\"2014-11-29T23:00:02.693Z\",\"avg\":9.375,\"hourlymax\":20,\"hourlymin\":3},{\"_date\":\"30_10_2014\",\"max\":55526,\"min\":55288,\"sold\":238,\"date\":\"2014-11-30T23:00:03.021Z\",\"avg\":9.916666666666666,\"hourlymax\":22,\"hourlymin\":2},{\"_date\":\"1_11_2014\",\"max\":55656,\"min\":55537,\"sold\":119,\"date\":\"2014-12-01T19:00:02.745Z\",\"avg\":5.95,\"hourlymax\":14,\"hourlymin\":1},{\"_date\":\"2_11_2014\",\"max\":55844,\"min\":55724,\"sold\":120,\"date\":\"2014-12-02T23:00:02.898Z\",\"avg\":7.0588235294117645,\"hourlymax\":16,\"hourlymin\":2},{\"_date\":\"3_11_2014\",\"max\":55961,\"min\":55853,\"sold\":108,\"date\":\"2014-12-03T18:00:02.465Z\",\"avg\":5.684210526315789,\"hourlymax\":15,\"hourlymin\":1}]");
			if (fake) {
				$.ajax = function(config) {
					config.success(fakeData);
				};
			};

			google.load("visualization", "1", {
				packages : ["corechart"]
			});
			google.setOnLoadCallback(loadAndDraw);

			function getHistoryWindow(array, size,offset)
			{
				var ret = [];
				
				for (var i = 0; i < size; i++) {
				
					var currIndex = i+offset-size;
					if(currIndex < 0) ret.push(0);
					else if(currIndex >= array.length) ret.push(0);
					else
					{
						ret.push(array[currIndex]);
					} 
				}
				return ret;
				
			}
			function foldArray(array)
			{
				var ret = [];
				for (var i = 0; i < array.length; i++) {
					
					if(i > 0 && array[i-1] > 0)
					{
						ret.push(array[i]-array[i-1]);
					}
				}
				return ret;
			}
			function avg(array)
			{
				var ret = 0;
				var greaterNullEntries = 0;
				for (var i = 0; i < array.length; i++) {
					
					if(array[i] > 0)
					{
						ret += array[i];
						greaterNullEntries++;
					}
				}
				if(greaterNullEntries == 0) greaterNullEntries = 1;
				return ret/greaterNullEntries;
			}
			function makeArray(complex, accessor)
			{
				
				var ret = [];
				for (var i = 0 ; i < complex.length; i++) {
						ret.push(accessor(complex[i]));
				}
				return ret;
			}
			function makeArray2(complex, accessor, accessorFirst)
			{
				
				var ret = [];
				for ( var i = 0 ; i < complex.length; i++) {
					if(i == 0){
						ret.push(accessorFirst(complex[i]));
					}
					else 
					{
						ret.push(accessor(complex[i])-accessor(complex[i-1]));
					}
				}
				return ret;
			}
			
			function ensureValid(value)
			{
				if( value == 999999999)
				{
					return 0;
				}
				return value;
			}
			function fixHoles(rawData)
			{
				var ret = [];
				for (var i = 0; i < rawData.length; i++) {
				
					
					if(i > 0)
					{
						var parsedDateI = new Date(Date.parse(rawData[i].date));
						var parsedDateI_Min1 = new Date(Date.parse(rawData[i-1].date));
						
						var diff = parsedDateI.getTime() - parsedDateI_Min1.getTime();
						var days = (diff / (1000 * 60 * 60 * 24));
						if(days > 1.1)
						{
							var insertCount = Math.floor(days);
							var soldDiff = rawData[i].max - rawData[i-1].max;
							var daylyAdd = Math.floor(soldDiff/insertCount);
							for(var k = 0; k < insertCount-1 ;k++)
							{
								var newObject = JSON.parse(JSON.stringify(rawData[i-1]));
								newObject.max = rawData[i-1].max + (daylyAdd*(k+1));
								newObject.date = new Date(parsedDateI_Min1.getYear()+1900, parsedDateI_Min1.getMonth(), parsedDateI_Min1.getDate()+k, 23, 0, 0, 0).toString();
							
								ret.push(newObject);
							}
						}
					
					}
					ret.push(rawData[i]);
				}
				return ret;
			}
			function constrain(rawDataTable, count)
			{
				if(rawDataTable.length > count)
				{
					var start = rawDataTable.length - count;
					
					return  rawDataTable.slice(start);
				}
				return rawDataTable;
			}
			function buildTable(rawDataTable) {
				var composite = {
					overall : "",
					dayly : ""
				};
				
				rawDataTable = constrain(rawDataTable, 320);
								
				composite.dayly = [["Date", "Sold that day","Max Per Hour","Min Per Hour","Avg per Hour","7-Day Avg"]];
				composite.overall = [["Date", "Sold","14-Day Projected"]];
				rawDataTable = fixHoles(rawDataTable);
				var soldbase = makeArray(rawDataTable,function (entry){ return parseInt(entry.max);});
				var solddailybase = makeArray2(rawDataTable,function (entry){ return parseInt(entry.max);},function (entry){ return parseInt(entry.sold);});
				
					
				for (var i = 0; i < rawDataTable.length; i++) {
					var rawEntry = rawDataTable[i];
					var parsedDate = new Date(Date.parse(rawEntry.date));
					var formated = parsedDate.toUTCString();
					
					var projectedOverall = 0;
					var projectedDaily = 0;
					
					if(i > 0)
					{
						var avggrowth = avg(foldArray(getHistoryWindow(soldbase,14,i)));
						var avggrowthDaily = avg(getHistoryWindow(solddailybase,7,i));
						
						projectedOverall = !isNaN(avggrowth)? soldbase[i-1]+avggrowth : soldbase[i];
						projectedDaily = !isNaN(avggrowthDaily)? avggrowthDaily : solddailybase[i];
					}
					else {
						projectedOverall = parseInt(rawEntry.max);
						projectedDaily = parseInt(rawEntry.sold);
					}
					//parseInt(rawEntry.sold)
					var entryDayly = [formated, solddailybase[i],parseInt(rawEntry.hourlymax),ensureValid(parseInt(rawEntry.hourlymin)),parseFloat(rawEntry.avg),projectedDaily];
					var entryOverall = [formated, parseInt(rawEntry.max),projectedOverall];
					
					composite.dayly.push(entryDayly);
					composite.overall.push(entryOverall);
				}
				return composite;
			}
			function removeFirst(array)
			{
				 var a = array.splice(0,1);
				 return array;
			}
			function loadAndDraw() {
				$.ajax({
					url : 'http://nodetwo.cloudapp.net/getFactorioSalesData',
					success : function(data) {
						var graphdata = buildTable(removeFirst(data));

						var optionsOverall = {
							title : "Overall Factorio Sales", //'Company Performance',
							hAxis : {
								title : 'Sales',
								titleTextStyle : {
									color : 'red'
								}
							}
						};
						var optionsDaly = {
							title : "Daily Factorio Sales", //'Company Performance',
							hAxis : {
								title : 'Sales',
								titleTextStyle : {
									color : 'red'
								}
							},
							seriesType: "bars",
         					series: {3: {type: "line"}, 4:{type: "line"}}
						};

						drawChart( graphdata.overall, optionsOverall, function(element) {
							return new google.visualization.LineChart(document.getElementById('chart_div'))
						});
						drawChart( graphdata.dayly, optionsDaly, function(element) {
							return new google.visualization.ColumnChart(document.getElementById('chart_div_perDay'))
						});
					},
					error : function(err, text) {
						$("#console").append(text);
					}
				});
			}

			function drawChart(input, options, chartFactory) {
				var data = google.visualization.arrayToDataTable(input);

				var chart = chartFactory();
				//new google.visualization.ColumnChart();
				chart.draw(data, options);
			}
		</script>
	</head>
	<body>
		<div><a href='http://factorio.com'>Factorio, the game's website</a></div>
		<div id="chart_div" style="width: 1000px; height: 450px;"></div>
		<div id="chart_div_perDay" style="width: 1000px; height: 450px;"></div>

		<div id="console"></div>
	</body>
</html>